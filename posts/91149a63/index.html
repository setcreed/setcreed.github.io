<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>01-网络基础 | 伊甸园</title><meta name="author" content="SetCreed"><meta name="copyright" content="SetCreed"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="网络基础概念 为实现资源共享，彼此互联的多个计算机设备就形成了网络 为实现通信，设备间必须共同遵守相同的通信协议 TCP&#x2F;IP协议族 标识彼此地址、收发和处理相同约定的数据包 分组交换即包换网络，分层头部、数据 速度由频率决定   网络分层 物理层、网络层、传输层、应用层 将复杂的问题分解为多层的简单的问题，层间遵守相同的接口    123# 查看网卡信息sudo lshw -class netw">
<meta property="og:type" content="article">
<meta property="og:title" content="01-网络基础">
<meta property="og:url" content="https://setcreed.github.io/posts/91149a63/index.html">
<meta property="og:site_name" content="伊甸园">
<meta property="og:description" content="网络基础概念 为实现资源共享，彼此互联的多个计算机设备就形成了网络 为实现通信，设备间必须共同遵守相同的通信协议 TCP&#x2F;IP协议族 标识彼此地址、收发和处理相同约定的数据包 分组交换即包换网络，分层头部、数据 速度由频率决定   网络分层 物理层、网络层、传输层、应用层 将复杂的问题分解为多层的简单的问题，层间遵守相同的接口    123# 查看网卡信息sudo lshw -class netw">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://setcreed.oss-cn-shanghai.aliyuncs.com/images/material-12.png">
<meta property="article:published_time" content="2022-02-27T08:55:19.000Z">
<meta property="article:modified_time" content="2023-11-15T12:51:34.638Z">
<meta property="article:author" content="SetCreed">
<meta property="article:tag" content="ubuntu">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://setcreed.oss-cn-shanghai.aliyuncs.com/images/material-12.png"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://setcreed.github.io/posts/91149a63/index.html"><link rel="preconnect" href="//unpkg.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://unpkg.com/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://unpkg.com/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://unpkg.com/@fancyapps/ui/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"距离上次更新已经过了","messageNext":"天，文章所描述的内容可能已经发生变化，请留意。"},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":500},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体中文","cht_to_chs":"你已切换为简体中文","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://unpkg.com/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '01-网络基础',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-11-15 20:51:34'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/custom/custom.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/custom/icon.css" media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="伊甸园" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">82</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">35</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">26</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> 读书</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 图库</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://setcreed.oss-cn-shanghai.aliyuncs.com/images/material-12.png')"><nav id="nav"><span id="blog-info"><a href="/" title="伊甸园"><span class="site-name">伊甸园</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> 读书</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 图库</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">01-网络基础</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2022-02-27T08:55:19.000Z" title="发表于 2022-02-27 16:55:19">2022-02-27</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ubuntu/">ubuntu</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>14分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="01-网络基础"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="网络基础"><a href="#网络基础" class="headerlink" title="网络基础"></a>网络基础</h1><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><ul>
<li>为实现资源共享，彼此互联的多个计算机设备就形成了网络</li>
<li>为实现通信，设备间必须共同遵守相同的通信协议<ul>
<li>TCP/IP协议族</li>
<li>标识彼此地址、收发和处理相同约定的数据包</li>
<li>分组交换即包换网络，分层头部、数据</li>
<li>速度由频率决定</li>
</ul>
</li>
<li>网络分层<ul>
<li>物理层、网络层、传输层、应用层</li>
<li>将复杂的问题分解为多层的简单的问题，层间遵守相同的接口</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看网卡信息</span></span><br><span class="line">sudo lshw -class network</span><br><span class="line">ifconfig -a</span><br></pre></td></tr></table></figure>
<h2 id="ubuntu18-04网络配置"><a href="#ubuntu18-04网络配置" class="headerlink" title="ubuntu18.04网络配置"></a>ubuntu18.04网络配置</h2><h3 id="使用netplan配置"><a href="#使用netplan配置" class="headerlink" title="使用netplan配置"></a>使用netplan配置</h3><p><code>/etc/network/interfaces</code>已经没有这个文件了</p>
<p>使用Rerender</p>
<ul>
<li>NetworkManager      桌面系统</li>
<li>systemd-networked     服务器</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/netplan/50-cloud-init.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># 自动获取ip，dhcp</span></span><br><span class="line">network:</span><br><span class="line">    ethernets:</span><br><span class="line">        enp0s3:</span><br><span class="line">            dhcp4: <span class="literal">true</span></span><br><span class="line">    version: 2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置如下，使用的是静态IP</span></span><br><span class="line">network:</span><br><span class="line">version: 2</span><br><span class="line">    renderer: networked</span><br><span class="line">    ethernets:</span><br><span class="line">        enp4s0:</span><br><span class="line">        	dhcp4: <span class="literal">false</span></span><br><span class="line">        	dhcp6: <span class="literal">false</span></span><br><span class="line">            addresses: [192.168.0.20/24]  //IP址</span><br><span class="line">            gateway4: 192.168.0.1  // 网关</span><br><span class="line">            nameservers:</span><br><span class="line">            	addresses: [114.114.114.114, 192.168.0.1] //DNS</span><br><span class="line">            	search: []</span><br><span class="line">            optional: <span class="literal">true</span></span><br><span class="line">    </span><br></pre></td></tr></table></figure>
<p>启用生效，重启网络</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo netplan apply</span><br></pre></td></tr></table></figure>
<h3 id="ip命令"><a href="#ip命令" class="headerlink" title="ip命令"></a>ip命令</h3><h4 id="ip-link"><a href="#ip-link" class="headerlink" title="ip link"></a>ip link</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ip <span class="built_in">link</span> <span class="built_in">set</span> ens33 up</span><br><span class="line">ip <span class="built_in">link</span> <span class="built_in">set</span> ens33 down</span><br><span class="line"></span><br><span class="line">ip -s -s -d <span class="built_in">link</span> <span class="built_in">ls</span> ens33         <span class="comment"># 详细信息</span></span><br><span class="line">ip <span class="built_in">link</span> <span class="built_in">set</span> dev ens33 mtu 1500    <span class="comment"># 修改MTU</span></span><br><span class="line">ip <span class="built_in">link</span> <span class="built_in">set</span> dev ens33 address 00:11:22:33:44:55 <span class="comment"># 修改mac</span></span><br></pre></td></tr></table></figure>
<h4 id="ip-addr"><a href="#ip-addr" class="headerlink" title="ip addr"></a>ip addr</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ip addr show</span><br><span class="line">ip addr add dev ens33 192.168.1.1/24</span><br><span class="line">ip addr del dev ens33 192.168.1.1/24</span><br><span class="line">ip addr flush dev ens33                <span class="comment"># 删除所有地址</span></span><br></pre></td></tr></table></figure>
<h4 id="ip-route-路由信息"><a href="#ip-route-路由信息" class="headerlink" title="ip route   路由信息"></a>ip route   路由信息</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ip route show</span><br><span class="line">ip route get 1.1.1.1     <span class="comment"># 去往这个ip</span></span><br><span class="line">ip route add default via 192.168.1.1      <span class="comment"># 添加默认路由</span></span><br><span class="line">ip route add dev wlp3s0 2.0.0.0/8 via 192.168.1.1   <span class="comment"># 添加指定路由</span></span><br></pre></td></tr></table></figure>
<h4 id="ip-maddress-多播地址，组播地址"><a href="#ip-maddress-多播地址，组播地址" class="headerlink" title="ip maddress   多播地址，组播地址"></a>ip maddress   多播地址，组播地址</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ip maddress <span class="built_in">ls</span> ens33</span><br><span class="line"></span><br><span class="line">ip maddress add 33:33:00:00:00:01 dev ens33</span><br></pre></td></tr></table></figure>
<h4 id="ip-neighbor-ARP地址表相关"><a href="#ip-neighbor-ARP地址表相关" class="headerlink" title="ip neighbor   ARP地址表相关"></a>ip neighbor   ARP地址表相关</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ip -s -s neighbor show           <span class="comment">#  查看ARP表</span></span><br><span class="line">ip neighbor add dev wlp3s0 10.1.1.1 lladdr 0:0:0:0:0:1  nud permit <span class="comment"># 添加一条 ARP 相关表项</span></span><br></pre></td></tr></table></figure>
<h2 id="DNS配置"><a href="#DNS配置" class="headerlink" title="DNS配置"></a>DNS配置</h2><h3 id="主机名解析"><a href="#主机名解析" class="headerlink" title="主机名解析"></a>主机名解析</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/hosts            <span class="comment"># 这里的解析优先级高于resolv.conf</span></span><br><span class="line"></span><br><span class="line">127.0.0.1 localhost</span><br><span class="line">127.0.1.1 u</span><br></pre></td></tr></table></figure>
<h3 id="名称解析顺序配置文件"><a href="#名称解析顺序配置文件" class="headerlink" title="名称解析顺序配置文件"></a>名称解析顺序配置文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/nsswitch.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># /etc/nsswitch.conf</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Example configuration of GNU Name Service Switch functionality.</span></span><br><span class="line"><span class="comment"># If you have the `glibc-doc-reference&#x27; and `info&#x27; packages installed, try:</span></span><br><span class="line"><span class="comment"># `info libc &quot;Name Service Switch&quot;&#x27; for information about this file.</span></span><br><span class="line"></span><br><span class="line">passwd:         compat systemd</span><br><span class="line">group:          compat systemd</span><br><span class="line">shadow:         compat</span><br><span class="line">gshadow:        files</span><br><span class="line"></span><br><span class="line">hosts:          files mdns4_minimal [NOTFOUND=<span class="built_in">return</span>] dns myhostname</span><br><span class="line">networks:       files</span><br><span class="line"></span><br><span class="line">protocols:      db files</span><br><span class="line">services:       db files</span><br><span class="line">ethers:         db files</span><br><span class="line">rpc:            db files</span><br><span class="line"></span><br><span class="line">netgroup:       nis</span><br><span class="line">~                                                                               </span><br><span class="line">~                                                                               </span><br><span class="line">~                                                                               </span><br><span class="line">     </span><br></pre></td></tr></table></figure>
<p>只需关注：<code>hosts:          files mdns4_minimal [NOTFOUND=return] dns myhostname</code></p>
<ul>
<li>files                                              在<code>/etc/hosts</code></li>
<li>Resolve                                       systemd-resolved.service(缓存、localhost、本机名)</li>
<li>[NOTFOUND=return]            mdns结果即权威</li>
<li>dns                                                DNS服务器</li>
<li>mdns4_minimal                      Multicast    DNS  多播DNS服务器</li>
</ul>
<h2 id="网桥配置（桥接）"><a href="#网桥配置（桥接）" class="headerlink" title="网桥配置（桥接）"></a>网桥配置（桥接）</h2><p>将多个以太网段以 上层协议透明的方式链接在一起</p>
<ul>
<li>二层转发，对三层协议透明</li>
<li>启用防火墙可与流量过滤</li>
<li>桥接宿主机与虚拟机网络，使虚拟机访问外部网络</li>
<li>桥接有线网与无线网</li>
<li>链路冗余容错（需启用STP）</li>
<li>通过网桥管理工具实现bridge-utils</li>
</ul>
<p>在vmware虚拟机上设置两块网卡，一个网卡为nat模式，另一个为仅主机模式</p>
<h2 id="网桥桥接"><a href="#网桥桥接" class="headerlink" title="网桥桥接"></a>网桥桥接</h2><ul>
<li>安装网桥管理包</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install bridge-utils</span><br></pre></td></tr></table></figure>
<p>用<code>brctl</code>命令来添加网桥</p>
<h3 id="临时配置"><a href="#临时配置" class="headerlink" title="临时配置"></a>临时配置</h3><ul>
<li><code>sudo brctl addbr br0</code>  添加网桥，命名为br0，然后ifconfig -a机会看到多了一块网桥br0</li>
<li><code>sudo brctl addif br0 ens32 ens35</code>   在br0里添加ens32和ens35，架起桥梁。</li>
<li>把加入到网桥的网卡的ip设为0.0.0.0, 可以先把网卡down掉再改ip</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo ifconfig ens32 0.0.0.0 up</span><br><span class="line">sudo ifconfig ens35 0.0.0.1 up</span><br></pre></td></tr></table></figure>
<ul>
<li>给网桥网卡分配ip，这里是静态</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ifconfig br0 1.1.1.1/24 up</span><br></pre></td></tr></table></figure>
<ul>
<li>也可以动态分配ip</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo dhclient br0</span><br></pre></td></tr></table></figure>
<ul>
<li>sudo route add default gw 1.1.1.10</li>
</ul>
<h3 id="持久配置"><a href="#持久配置" class="headerlink" title="持久配置"></a>持久配置</h3><p>ubuntu18.04网络配置文件已经不在<code>/etc/network/interface</code>下了，而是在<code>/etc/netplan/</code>的文件中</p>
<p>添加下列配置</p>
<p>这是<code>/etc/network/interface</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">auto ens32</span><br><span class="line">iface ens32 inet manual</span><br><span class="line">auto ens35</span><br><span class="line">iface ens35 inet manual</span><br><span class="line">auto br0</span><br><span class="line">iface br0 inet dhcp</span><br><span class="line">bridge_ports ens32 ens35</span><br><span class="line">bridge_stp off</span><br></pre></td></tr></table></figure>
<p>重启服务</p>
<ul>
<li>sudo systemctl restart networking</li>
<li>sudo service networking restart</li>
<li>sudo /etc/init.d/networking restart</li>
</ul>
<p>在<code>/etc/netplan/</code>目录下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">network:</span><br><span class="line">    ethernets:</span><br><span class="line">        ens33:</span><br><span class="line">            dhcp4: <span class="literal">false</span></span><br><span class="line">        ens38:</span><br><span class="line">            dhcp4: <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    bridges:</span><br><span class="line">        br0:</span><br><span class="line">            interfaces: [ens33]</span><br><span class="line">            interfaces: [ens38]</span><br><span class="line">            dhcp4: <span class="literal">true</span></span><br><span class="line">    version: 2</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>重启网卡： <code>netplan apply</code></p>
<p><code>netplan --debug apply</code>  如果网络配置出错了，可以这样查看</p>
<h3 id="查看网桥信息"><a href="#查看网桥信息" class="headerlink" title="查看网桥信息"></a>查看网桥信息</h3><ul>
<li>brctl show</li>
<li>brctl showmacs br0</li>
<li>brctl showstp br0</li>
</ul>
<h2 id="网卡绑定"><a href="#网卡绑定" class="headerlink" title="网卡绑定"></a>网卡绑定</h2><p>作用：</p>
<ul>
<li>当一个网卡不够用的时候，可以使用两个网卡绑定在一起增加带宽</li>
<li>当一个网卡断的话，另一个网卡可以形成备份，增加链路冗余</li>
<li>主备模式只能做成链路备份，不能负载，负载需要服务器和交换机互相配合</li>
<li>将多个物理网卡组合为一个逻辑网卡，实现高可用、负载均衡、高吞吐量</li>
</ul>
<h2 id="多网卡绑定"><a href="#多网卡绑定" class="headerlink" title="多网卡绑定"></a>多网卡绑定</h2><h3 id="bond的7种模式"><a href="#bond的7种模式" class="headerlink" title="bond的7种模式"></a>bond的7种模式</h3><ul>
<li>mode=0 round-robin轮询策略(Round-robin policy)</li>
<li>mode=1 active-backup主备策略(Active-backup policy)</li>
<li>mode=2 load balancing (xor)异或策略(XOR policy)</li>
<li>mode=3 fault-tolerance (broadcast)广播策略(Broadcast policy)</li>
<li>mode=4 lacp IEEE 802.3ad 动态链路聚合(IEEE 802.3ad Dynamic link aggregation)</li>
<li>mode=5 transmit load balancing适配器传输负载均衡(Adaptive transmit load balancing)</li>
<li>mode=6 adaptive load balancing适配器负载均衡(Adaptive load balancing)</li>
</ul>
<h3 id="主备模式-active-backup："><a href="#主备模式-active-backup：" class="headerlink" title="主备模式 active-backup："></a>主备模式 active-backup：</h3><ul>
<li><p>这个是主备模式，只有一块网卡是active，另一块是备用的standby，所有流量都在active链路上处理。</p>
</li>
<li><p>注意：交换机不能做聚合端口，因为交换机配置的是捆绑的话将不能工作，因为交换机往两块网卡发包，有一半包是丢弃的。</p>
</li>
<li><p>特点：只有一个设备处于活动状态，当一个宕掉另一个马上由备份转换为主设备。mac地址是外部可见得，从外面看来，bond的MAC地址是唯一的，以避免switch(交换机)发生混乱。</p>
</li>
<li><p>此模式只提供了容错能力；由此可见此算法的优点是可以提供高网络连接的可用性，但是它的资源利用率较低，只有一个接口处于工作状态。</p>
</li>
</ul>
<h3 id="动态链接聚合-802-3ad："><a href="#动态链接聚合-802-3ad：" class="headerlink" title="动态链接聚合 802.3ad："></a>动态链接聚合 802.3ad：</h3><ul>
<li>表示支持802.3ad协议，和交换机的聚合LACP方式配合（需要xmit_hash_policy）.标准要求所有设备在聚合操作时，要在同样的速率和双工模式，而且，和除了balance-rr模式外的其它bonding负载均衡模式一样，任何连接都不能使用多于一个接口的带宽</li>
<li>特点：创建一个聚合组，它们共享同样的速率和双工设定。根据802.3ad规范将多个slave工作在同一个激活的聚合体下。</li>
<li>必要条件：在交换机和服务器上都需要配置动态链路聚合</li>
</ul>
<h3 id="主备模式做绑定"><a href="#主备模式做绑定" class="headerlink" title="主备模式做绑定"></a>主备模式做绑定</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/netplan/50-cloud-init.yaml</span><br><span class="line"></span><br><span class="line">network:</span><br><span class="line">    version: 2</span><br><span class="line">    ethernets:</span><br><span class="line">        ens33:</span><br><span class="line">            dhcp4: no</span><br><span class="line">            dhcp6: no</span><br><span class="line">        ens38:</span><br><span class="line">            dhcp4: no</span><br><span class="line">            dhcp6: no</span><br><span class="line">    bonds:</span><br><span class="line">        bond0:</span><br><span class="line">            interfaces:</span><br><span class="line">              - ens33</span><br><span class="line">              - ens38</span><br><span class="line">            addresses: [192.168.19.30/24]</span><br><span class="line">            gateway4: 192.168.19.2</span><br><span class="line">            nameservers:</span><br><span class="line">                addresses: [223.5.5.5,223.6.6.6]</span><br><span class="line">            parameters:</span><br><span class="line">                mode: active-backup</span><br><span class="line">                mii-monitor-interval: 100</span><br></pre></td></tr></table></figure>
<h3 id="双网卡绑定并桥接"><a href="#双网卡绑定并桥接" class="headerlink" title="双网卡绑定并桥接"></a>双网卡绑定并桥接</h3><p>先做网络绑定，然后桥接选择接口，选择绑定的网络。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/netplan/50-cloud-init.yaml</span><br><span class="line"></span><br><span class="line">network:</span><br><span class="line">    version: 2</span><br><span class="line">    ethernets:</span><br><span class="line">        ens33:</span><br><span class="line">            dhcp4: no</span><br><span class="line">            dhcp6: no</span><br><span class="line">        ens38:</span><br><span class="line">            dhcp4: no</span><br><span class="line">            dhcp6: no</span><br><span class="line">    bonds:</span><br><span class="line">        bond0:</span><br><span class="line">            interfaces:</span><br><span class="line">              - ens33</span><br><span class="line">              - ens38</span><br><span class="line">            parameters:</span><br><span class="line">                mode: active-backup</span><br><span class="line">                mii-monitor-interval: 100</span><br><span class="line">    bridges:</span><br><span class="line">        br0:</span><br><span class="line">            dhcp4: no</span><br><span class="line">            dhcp6: no</span><br><span class="line">            addresses: [192.168.19.30/24]</span><br><span class="line">            gateway4: 192.168.19.2</span><br><span class="line">            nameservers:</span><br><span class="line">                addresses: [223.5.5.5,223.6.6.6]</span><br><span class="line">            interfaces:</span><br><span class="line">              - bond0</span><br></pre></td></tr></table></figure>
<h2 id="DHCP服务"><a href="#DHCP服务" class="headerlink" title="DHCP服务"></a>DHCP服务</h2><p>Dynamic Host Configuration Protocol</p>
<h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>自动分配网络设置</p>
<ul>
<li>透明的配置网络参数</li>
<li>IP/掩码, 网关, DNS, 域名, 主机名, 时间服务器, 打印服务器</li>
<li>通过地址租约循环使用IP地址</li>
<li>UDP 67 / 68     基于udp协议之上的一个应用层的协议,使用udp协议的端口67和68    标准的DHCP, 服务器使用67端口, 客户端使用68端口</li>
</ul>
<p>客户端连上网络,就要获取ip, 就要发送广播,  发送一个叫<strong>discover</strong>的数据包, 通过二层广播, 喊”谁有ip啊”,   而DHCP服务端一直在监听, 听到后会立即相应, 回给客户端一个称之为<strong>offer</strong>的数据包.   客户端会再发一个request请求包, 服务端收到后会发送一个确认包,  客户端得到确认后会使用服务端给的ip地址等</p>
<h3 id="安装配置"><a href="#安装配置" class="headerlink" title="安装配置"></a>安装配置</h3><p>在虚拟机上做实验,要把虚拟机上的DHCP服务关掉, 避免对ubuntu server造成影响</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install isc-dhcp-server   <span class="comment"># 安装DHCP服务端</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置dhcp服务端</span></span><br><span class="line">sudo vim /etc/default/isc-dhcp-server    <span class="comment"># 指定启动DHCP服务的网卡</span></span><br><span class="line"><span class="comment"># 修改配置, 添加网卡名称</span></span><br><span class="line">INTERFACESv4=<span class="string">&quot;ens33&quot;</span></span><br><span class="line"></span><br><span class="line">sudo vim /etc/dhcp/dhcpd.conf    <span class="comment"># 主配置文件(指定址池)</span></span><br></pre></td></tr></table></figure>
<p>主配置文件:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">dhcpd.conf</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Sample configuration file for ISC dhcpd</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Attention: If /etc/ltsp/dhcpd.conf exists, that will be used as</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">configuration file instead of this file.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"></span><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">option definitions common to all supported networks...</span></span><br><span class="line">option domain-name &quot;example.org&quot;;</span><br><span class="line">option domain-name-servers 172.16.247.1, 8.8.4.4;</span><br><span class="line"></span><br><span class="line">default-lease-time 600;   # 租约期限, 用到期限的一半, 客户端就会跟服务端更新租约期限, 有变成了10分钟</span><br><span class="line">max-lease-time 7200;  # 到两小时, 又要重新获取ip</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">The ddns-updates-style parameter controls whether or not the server will</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">attempt to <span class="keyword">do</span> a DNS update when a lease is confirmed. We default to the</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">behavior of the version 2 packages (<span class="string">&#x27;none&#x27;</span>, since DHCP v2 didn<span class="string">&#x27;t</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">have support for DDNS.)</span></span></span><br><span class="line">ddns-update-style none;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">If this DHCP server is the official DHCP server for the local</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">network, the authoritative directive should be uncommented.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">authoritative;  授权服务器</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>有option 的配置是关于ip地址池  作用域的,  没有option的配置是作用于整个服务器的, 全局性的配置</p>
<p>在配置文件中任何位置添加：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">subnet 172.16.247.0 netmask 255.255.255.0 &#123;</span><br><span class="line">    range 172.16.247.100 172.16.247.200;   # 申明了地址池</span><br><span class="line">    option routers 172.16.247.1;  # 网关地址</span><br><span class="line">    option domain-name-servers 172.16.247.1, 202.106.0.20;  # dns</span><br><span class="line">    option domain-name &quot;lab.com&quot;;  # 域名</span><br><span class="line">    option ntp-servers 172.16.247.1; # 时间服务器</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>重启服务：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart isc-dhcp-server.service</span><br></pre></td></tr></table></figure>
<p>然后就可以啦</p>
<h3 id="DHCP地址保留"><a href="#DHCP地址保留" class="headerlink" title="DHCP地址保留"></a>DHCP地址保留</h3><p>给计算机保留IP地址</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/dhcp/dhcpd.conf </span><br><span class="line"><span class="comment"># 添加配置</span></span><br><span class="line"></span><br><span class="line">host name &#123;                                 <span class="comment"># 主机地址保留</span></span><br><span class="line">    hardware ethernet 00:0c:29:33:e3:b1;    <span class="comment"># 指定网卡mac地址</span></span><br><span class="line">    fixed-address 172.16.247.8;            <span class="comment"># 子网内地址，可为range外地址</span></span><br><span class="line">&#125;  <span class="comment"># 记录mac地址，指定分发ip</span></span><br></pre></td></tr></table></figure>
<h3 id="日志与状态查看"><a href="#日志与状态查看" class="headerlink" title="日志与状态查看"></a>日志与状态查看</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cat /var/lib/dhcp/dhcp.leases   # 服务器地址租约结果</span><br><span class="line">tail -f /var/log/syslog  # 日志文件</span><br><span class="line">systemctl status isc-dhcp-server.service  # 服务器状态</span><br><span class="line">less /var/lib/dhcp/dhclient.leases   # 客户端获得地址</span><br></pre></td></tr></table></figure>
<h2 id="NTP服务"><a href="#NTP服务" class="headerlink" title="NTP服务"></a>NTP服务</h2><h3 id="网络时间协议"><a href="#网络时间协议" class="headerlink" title="网络时间协议"></a>网络时间协议</h3><p>计时方法</p>
<ul>
<li>太阳照影、滴水、烧香、电子、石英原子时钟</li>
<li>Drift是计时器时间与真实时间之间的偏移量</li>
<li>基于铯133的原子时钟每3亿年误差为1秒</li>
</ul>
<p>时间标准</p>
<ul>
<li>GMT：格林威治标准时间</li>
<li>UTC：世界协调时间</li>
<li>CST：China Standard Time UT+8:00</li>
</ul>
<p>计算机技术对时间非常敏感</p>
<ul>
<li>IPSec、AD、SSL</li>
<li>日志审计</li>
<li>电子元器件相互干扰加大时间偏移</li>
</ul>
<p>如何保证时间准确</p>
<ul>
<li>不停地同步时间</li>
<li>永远无法精确同步（网络通信延时影响时间同步精度）</li>
</ul>
<h3 id="NTP协议的分层结构"><a href="#NTP协议的分层结构" class="headerlink" title="NTP协议的分层结构"></a>NTP协议的分层结构</h3><ul>
<li>从核心向外0-16层</li>
<li>0代表时间源</li>
<li>1-15代表逐级同步的时间服务器（越接近0时间越精确）</li>
<li>16代表尚未同步（不作为时间同步源）</li>
<li>客户端服务器全部使用udp 123端口通信</li>
</ul>
<p>每个移动设备都运行NTP协议</p>
<ul>
<li>硬件时钟：RTC（主板电池）</li>
<li>系统时钟：Local time</li>
</ul>
<h2 id="NTP客户端"><a href="#NTP客户端" class="headerlink" title="NTP客户端"></a>NTP客户端</h2><p>NTP客户端</p>
<ul>
<li>客户端程序从时间服务器同步时间</li>
<li>系统启动时自动同步时间</li>
<li>网口激活时自动同步运行</li>
<li>手动同步时间</li>
</ul>
<p>客户端命令：</p>
<ul>
<li>timedatectl</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cwz@ubuntu_server:~$ timedatectl </span><br><span class="line">                      Local time: Fri 2019-10-25 10:20:32 UTC</span><br><span class="line">                  Universal time: Fri 2019-10-25 10:20:32 UTC</span><br><span class="line">                        RTC time: Fri 2019-10-25 10:20:32</span><br><span class="line">                       Time zone: Etc/UTC (UTC, +0000)</span><br><span class="line">       System clock synchronized: yes</span><br><span class="line">systemd-timesyncd.service active: yes</span><br><span class="line">                 RTC in local TZ: no</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ntp客户端命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">timedatectrl list-timezones   # 列出所有时区</span><br><span class="line">timedatectrl set-timezone     # 设置时区</span><br><span class="line">timedatectrl set-time &quot;2012-10-20 18:10:21&quot;  # 设置系统时间</span><br><span class="line">timedatectrl set-ntp true    # 开启网络时间同步服务</span><br><span class="line">systemctl status systemd-timesyncd.service   # 查看时间同步服务运行状态</span><br><span class="line">sudo hwclock -w    # 将系统时间写入硬件时间</span><br><span class="line">sudo hwclock -s    # 将硬件时间写入系统时间</span><br><span class="line">hwclock --set--date=&#x27;2012-08-08 12:01:50&#x27;</span><br></pre></td></tr></table></figure>
<h3 id="早期linux客户端程序：ntpdate"><a href="#早期linux客户端程序：ntpdate" class="headerlink" title="早期linux客户端程序：ntpdate"></a>早期linux客户端程序：ntpdate</h3><p>先安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install ntpdate          <span class="comment"># 安装</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sudo ntpdate ntp.ubuntu.com   <span class="comment"># 向指定服务器发起时间同步</span></span><br><span class="line">sudo ntpdate -d ntp.ubuntu.com   <span class="comment"># 显示时间同步详细过程</span></span><br><span class="line">sudo ntpdate -q ntp.ubuntu.com   <span class="comment"># 只查询时间，并不本地同步时间</span></span><br><span class="line">sudo ntpdate -u ntp.ubuntu.com   <span class="comment"># 随机源端口</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 一旦ntpdate/ntp, timedatectl将被禁用</span></span><br></pre></td></tr></table></figure>
<h2 id="NTPD-时间服务器"><a href="#NTPD-时间服务器" class="headerlink" title="NTPD 时间服务器"></a>NTPD 时间服务器</h2><p>新版本系统使用timesyncd替换ntpd的客户端功能</p>
<p>ntpd: 客户端 + 服务器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install ntp    <span class="comment"># 安装ntp服务</span></span><br><span class="line">sudo systemctl status ntp  <span class="comment"># 查询服务状态</span></span><br><span class="line">sudo systemctl restart ntp <span class="comment"># 重启服务</span></span><br><span class="line">sudo vim /etc/ntp.conf   <span class="comment"># 配置文件</span></span><br></pre></td></tr></table></figure>
<p>配置：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pool 0.ubuntu.pool.ntp.org iburst</span><br><span class="line">pool 1.ubuntu.pool.ntp.org iburst</span><br><span class="line">pool 2.ubuntu.pool.ntp.org iburst</span><br><span class="line">pool 3.ubuntu.pool.ntp.org iburst</span><br><span class="line"><span class="comment"># 以上是/etc/ntp.conf文件中的官方的时间池</span></span><br><span class="line"></span><br><span class="line">如果不想用官方的时间服务器，可以手动添加服务器</span><br><span class="line">server 1.1.1.1</span><br><span class="line">fudge 127.127.1.1 stratum 10   <span class="comment"># 当设置的网络时间服务器不通时，可以使用本机的硬件时间作为备用时间服务器，但是要把层级设置的低一些  stratum 10</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ntpq -p       <span class="comment"># 可以详细的查看时间服务器的运行情况</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示的信息：</span></span><br><span class="line">remote   <span class="comment"># 本机正在连接的上级时间服务器</span></span><br><span class="line">refid   <span class="comment"># 上级服务器的上级时间服务器</span></span><br><span class="line">st      <span class="comment"># 服务器stratum层级</span></span><br><span class="line">t       <span class="comment"># 协议类型：unicast, broadcast,multicast,anycast</span></span><br><span class="line">when    <span class="comment"># 上一次查询服务器已过去的时间</span></span><br><span class="line">poll   <span class="comment"># 查询服务器的时间间隔</span></span><br><span class="line">reach   <span class="comment"># 最近8次查询结果成功，则值为377（8进制数），开始提供时间服务</span></span><br><span class="line">delay    <span class="comment"># 请求和响应之间的时间差（毫秒）</span></span><br><span class="line">offset   <span class="comment"># 本地时钟与时间服务器的时间偏移</span></span><br><span class="line">jitter   <span class="comment"># 与服务器的网络延时，此值应该小于100</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 每行第一个字符表示的意思：</span></span><br><span class="line">空表示无效主机</span><br><span class="line">x 已不再使用</span><br><span class="line">- 已不再使用</span><br><span class="line"><span class="comment"># 状态良好但未使用</span></span><br><span class="line">+ 良好且优先使用</span><br><span class="line">* 首选主同步主机</span><br></pre></td></tr></table></figure>
<h2 id="时间相关的命令"><a href="#时间相关的命令" class="headerlink" title="时间相关的命令"></a>时间相关的命令</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">date</span> --<span class="built_in">set</span> 2012-01-10      <span class="comment"># 设置日期</span></span><br><span class="line"><span class="built_in">date</span> --<span class="built_in">set</span> 21:10:0         <span class="comment"># 设置时间</span></span><br><span class="line"><span class="built_in">cat</span> /etc/timezone         <span class="comment"># 查看时区</span></span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://setcreed.github.io">SetCreed</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://setcreed.github.io/posts/91149a63/">https://setcreed.github.io/posts/91149a63/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://setcreed.github.io" target="_blank">伊甸园</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ubuntu/">ubuntu</a></div><div class="post_share"><div class="social-share" data-image="https://setcreed.oss-cn-shanghai.aliyuncs.com/images/material-12.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://unpkg.com/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://unpkg.com/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/2bac1285/" title="01-账号管理"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://setcreed.oss-cn-shanghai.aliyuncs.com/images/material-10.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">01-账号管理</div></div></a></div><div class="next-post pull-right"><a href="/posts/1c11a258/" title="01-存储管理"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://setcreed.oss-cn-shanghai.aliyuncs.com/images/material-6.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">01-存储管理</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/95a330b5/" title="01-DNS服务"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://setcreed.oss-cn-shanghai.aliyuncs.com/images/material-3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-27</div><div class="title">01-DNS服务</div></div></a></div><div><a href="/posts/863d965c/" title="01-HTTP协议"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://setcreed.oss-cn-shanghai.aliyuncs.com/images/material-1.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-27</div><div class="title">01-HTTP协议</div></div></a></div><div><a href="/posts/e6eedd2e/" title="01-前言"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://setcreed.oss-cn-shanghai.aliyuncs.com/images/material-3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-25</div><div class="title">01-前言</div></div></a></div><div><a href="/posts/7a166334/" title="01-包管理"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://setcreed.oss-cn-shanghai.aliyuncs.com/images/material-1.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-27</div><div class="title">01-包管理</div></div></a></div><div><a href="/posts/de30e1b5/" title="01-命令行基础"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://setcreed.oss-cn-shanghai.aliyuncs.com/images/material-4.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-25</div><div class="title">01-命令行基础</div></div></a></div><div><a href="/posts/1c11a258/" title="01-存储管理"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://setcreed.oss-cn-shanghai.aliyuncs.com/images/material-6.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-27</div><div class="title">01-存储管理</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">SetCreed</div><div class="author-info__description">读书、写代码、看电影</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">82</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">35</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">26</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/setcreed"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="/img/qq.jpg" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="/img/wechat_account.jpg" target="_blank" title="微信"><i class="fab fa-weixin"></i></a><a class="social-icon" href="https://github.com/setcreed" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:cwzdzg@foxmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80"><span class="toc-text">网络基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5"><span class="toc-text">概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ubuntu18-04%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE"><span class="toc-text">ubuntu18.04网络配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8netplan%E9%85%8D%E7%BD%AE"><span class="toc-text">使用netplan配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ip%E5%91%BD%E4%BB%A4"><span class="toc-text">ip命令</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ip-link"><span class="toc-text">ip link</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ip-addr"><span class="toc-text">ip addr</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ip-route-%E8%B7%AF%E7%94%B1%E4%BF%A1%E6%81%AF"><span class="toc-text">ip route   路由信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ip-maddress-%E5%A4%9A%E6%92%AD%E5%9C%B0%E5%9D%80%EF%BC%8C%E7%BB%84%E6%92%AD%E5%9C%B0%E5%9D%80"><span class="toc-text">ip maddress   多播地址，组播地址</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ip-neighbor-ARP%E5%9C%B0%E5%9D%80%E8%A1%A8%E7%9B%B8%E5%85%B3"><span class="toc-text">ip neighbor   ARP地址表相关</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DNS%E9%85%8D%E7%BD%AE"><span class="toc-text">DNS配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E6%9C%BA%E5%90%8D%E8%A7%A3%E6%9E%90"><span class="toc-text">主机名解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8D%E7%A7%B0%E8%A7%A3%E6%9E%90%E9%A1%BA%E5%BA%8F%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-text">名称解析顺序配置文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E6%A1%A5%E9%85%8D%E7%BD%AE%EF%BC%88%E6%A1%A5%E6%8E%A5%EF%BC%89"><span class="toc-text">网桥配置（桥接）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E6%A1%A5%E6%A1%A5%E6%8E%A5"><span class="toc-text">网桥桥接</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%B4%E6%97%B6%E9%85%8D%E7%BD%AE"><span class="toc-text">临时配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%81%E4%B9%85%E9%85%8D%E7%BD%AE"><span class="toc-text">持久配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E7%BD%91%E6%A1%A5%E4%BF%A1%E6%81%AF"><span class="toc-text">查看网桥信息</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E5%8D%A1%E7%BB%91%E5%AE%9A"><span class="toc-text">网卡绑定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E7%BD%91%E5%8D%A1%E7%BB%91%E5%AE%9A"><span class="toc-text">多网卡绑定</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#bond%E7%9A%847%E7%A7%8D%E6%A8%A1%E5%BC%8F"><span class="toc-text">bond的7种模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E5%A4%87%E6%A8%A1%E5%BC%8F-active-backup%EF%BC%9A"><span class="toc-text">主备模式 active-backup：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E8%81%9A%E5%90%88-802-3ad%EF%BC%9A"><span class="toc-text">动态链接聚合 802.3ad：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E5%A4%87%E6%A8%A1%E5%BC%8F%E5%81%9A%E7%BB%91%E5%AE%9A"><span class="toc-text">主备模式做绑定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8C%E7%BD%91%E5%8D%A1%E7%BB%91%E5%AE%9A%E5%B9%B6%E6%A1%A5%E6%8E%A5"><span class="toc-text">双网卡绑定并桥接</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DHCP%E6%9C%8D%E5%8A%A1"><span class="toc-text">DHCP服务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE"><span class="toc-text">安装配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DHCP%E5%9C%B0%E5%9D%80%E4%BF%9D%E7%95%99"><span class="toc-text">DHCP地址保留</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E4%B8%8E%E7%8A%B6%E6%80%81%E6%9F%A5%E7%9C%8B"><span class="toc-text">日志与状态查看</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NTP%E6%9C%8D%E5%8A%A1"><span class="toc-text">NTP服务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%97%B6%E9%97%B4%E5%8D%8F%E8%AE%AE"><span class="toc-text">网络时间协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NTP%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%88%86%E5%B1%82%E7%BB%93%E6%9E%84"><span class="toc-text">NTP协议的分层结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NTP%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-text">NTP客户端</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A9%E6%9C%9Flinux%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%A8%8B%E5%BA%8F%EF%BC%9Antpdate"><span class="toc-text">早期linux客户端程序：ntpdate</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NTPD-%E6%97%B6%E9%97%B4%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-text">NTPD 时间服务器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E7%9B%B8%E5%85%B3%E7%9A%84%E5%91%BD%E4%BB%A4"><span class="toc-text">时间相关的命令</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/c9fd1d24/" title="运维开发所需要知道的Linux基本知识"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://setcreed.oss-cn-shanghai.aliyuncs.com/images/202311050928440.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="运维开发所需要知道的Linux基本知识"/></a><div class="content"><a class="title" href="/posts/c9fd1d24/" title="运维开发所需要知道的Linux基本知识">运维开发所需要知道的Linux基本知识</a><time datetime="2023-11-04T14:27:22.000Z" title="发表于 2023-11-04 22:27:22">2023-11-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/b2fa1aad/" title="Linux的Namespace和CGroup"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://setcreed.oss-cn-shanghai.aliyuncs.com/images/202311050932278.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux的Namespace和CGroup"/></a><div class="content"><a class="title" href="/posts/b2fa1aad/" title="Linux的Namespace和CGroup">Linux的Namespace和CGroup</a><time datetime="2023-11-04T12:39:28.000Z" title="发表于 2023-11-04 20:39:28">2023-11-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/afe9ffa9/" title="家用服务器搭建使用指南"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://setcreed.oss-cn-shanghai.aliyuncs.com/images/202311032207863.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="家用服务器搭建使用指南"/></a><div class="content"><a class="title" href="/posts/afe9ffa9/" title="家用服务器搭建使用指南">家用服务器搭建使用指南</a><time datetime="2023-11-03T14:02:36.000Z" title="发表于 2023-11-03 22:02:36">2023-11-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/7ac9a020/" title="k8s-informer深入学习"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://setcreed.oss-cn-shanghai.aliyuncs.com/images/material-5.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="k8s-informer深入学习"/></a><div class="content"><a class="title" href="/posts/7ac9a020/" title="k8s-informer深入学习">k8s-informer深入学习</a><time datetime="2022-12-01T09:56:52.000Z" title="发表于 2022-12-01 17:56:52">2022-12-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/89a3df7f/" title="go刷题基础篇"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://setcreed.oss-cn-shanghai.aliyuncs.com/images/material-14.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="go刷题基础篇"/></a><div class="content"><a class="title" href="/posts/89a3df7f/" title="go刷题基础篇">go刷题基础篇</a><time datetime="2022-09-18T22:21:26.000Z" title="发表于 2022-09-19 06:21:26">2022-09-19</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By SetCreed</div><div class="footer_custom_text"><p><a style="margin-inline:5px" target="_blank" href="https://hexo.io/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为 Hexo" alt="HEXO"></a><a style="margin-inline:5px" target="_blank" href="https://butterfly.js.org/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用 Butterfly" alt="Butterfly"></a><a style="margin-inline:5px" target="_blank" href="https://github.com/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由 GitHub 托管" alt="GitHub"></a><a style="margin-inline:5px" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" alt="img" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://unpkg.com/@fancyapps/ui/dist/fancybox/fancybox.umd.js"></script><script src="https://unpkg.com/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://unpkg.com/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>